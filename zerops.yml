zerops:
  - setup: api
    build:
      base: nodejs@22
      prepareCommands:
        - npm install -g typescript
      buildCommands:
        - npm i --verbose
        - npm run build
      deployFiles:
        - ./dist
        - ./node_modules
        - ./package.json
      cache:
        - node_modules
        - package-lock.json
    run:
      base: nodejs@22
      ports:
        - port: 3000
          httpSupport: true
      envVariables:
        NODE_ENV: production
        DB_NAME: ${DB_NAME}
        DB_HOST: ${DB_HOST}
        DB_USER: ${DB_USER}
        DB_PASS: ${DB_PASS}
      start: npm run start:prod
      healthCheck:
        httpGet:
          port: 3000
          path: /status
